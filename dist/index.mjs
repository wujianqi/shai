var u=Object.defineProperty,f=(i,e,t)=>e in i?u(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,c=(i,e,t)=>(f(i,typeof e!="symbol"?e+"":e,t),t);function y(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function l(i){if(typeof globalThis!="undefined"&&globalThis.structuredClone)return structuredClone(i);const e=Array.isArray(i)?[]:{};for(const t in i)if(y(i,t)){const s=i[t];typeof s=="object"?e[t]=l(s):e[t]=s}return e}class p{constructor(){c(this,"__funcs",[]),c(this,"__data",[]),c(this,"__propKey","setting"),c(this,"__SB",Symbol()),this.use=this.use.bind(this),this.gen=this.gen.bind(this)}setVal(e,t){const s=e.length-1;e.reduce((r,a,o)=>(o===s&&(r[a]=t),r[a]),this.__data)}addChild(e,t,s){const r=s.key||"children",a=this.mapping(e,s);if(t<1)return a;{const o=l(a);t--;for(let n=0,h=o.length;n<h;n++)t===1?o[n][r]=l(a):o[n][r]=this.addChild(a[n],t,s);return o}}mapping(e,t){if(typeof e=="object"&&t){const s=o=>{let n=1;return typeof o=="number"?n=o:Array.isArray(o)&&typeof o[0]=="number"&&typeof o[1]=="number"&&(n=~~(Math.random()*(o[1]-o[0])+o[0])),n},r=typeof t=="number"||Array.isArray(t)&&typeof t[0]=="number"&&typeof t[1]=="number"?s(t):typeof t=="object"&&t.length?s(t.length):1,a=new Array(r);delete e[this.__propKey];for(let o=0;o<r;o++)a[o]=l(e);return a}else return e}parseBlock(){const e=s=>{const r=s[this.__propKey];if(!Array.isArray(r)&&typeof r=="object"){const a=typeof r.level=="number"?r.level:1;s=this.addChild(s,a,r)}else s=this.mapping(s,r);return s},t=(s,r)=>{!Array.isArray(s)&&y(s,this.__propKey)&&(s=e(s),r?this.setVal(r,s):this.setVal([],this.__data=s));for(const a in s)if(y(s,a)){const o=s[a];Array.isArray(o)&&o[0]!==this.__SB?o.forEach((n,h)=>t(n,r?r.concat([a,h]):[a,h])):!Array.isArray(o)&&typeof o=="object"&&t(o,r?r.concat([a]):[a])}};t(this.__data)}setValues(e,t){if(Array.isArray(e))if(e[0]===this.__SB){const s=t||[],r=this.__funcs[e[1]].concat();try{this.setVal(s,r.length>0?r[0](...r[1]):e)}catch(a){throw new Error(`${s.length>0?s.join("."):e}: error, ${a}`)}}else e.forEach((s,r)=>this.setValues(s,t?t.concat([r]):[r]));else typeof e=="object"&&Object.keys(e).forEach(s=>this.setValues(e[s],t?t.concat([s]):[s]))}use(e,...t){return[this.__SB,this.__funcs.push([e,t])-1]}gen(e,t){if(typeof e=="object")return t&&(this.__propKey=t),this.__data=e,this.parseBlock(),this.setValues(this.__data),this.__data}}export{p as default};
